import{u as e,a as s,d as a,j as t,B as l}from"./index-Bqz1fDHx.js";import{r as i}from"./vendor-npDLdgAy.js";import{m as r,q as o,p as d,r as c,w as n}from"./firebase-eG8A_CqU.js";import{u as p}from"./router-Cm2dkesr.js";import{a6 as u,Z as m,D as x}from"./ui-Dod0sQ3X.js";const f=()=>{const{user:f}=e(),{toast:h}=s(),v=p(),[j,w]=i.useState([]),[b,N]=i.useState(!0),y=i.useCallback(async()=>{try{N(!0);const e=r(a,"profiles"),s=o(e,d(10)),t=(await c(s)).docs.map(e=>({id:e.id,...e.data(),type:"vip"})),l=r(a,"profiles"),i=o(l,d(8)),p=(await c(i)).docs.map(e=>({id:e.id,...e.data(),type:"vip"})),u=r(a,"advertisements"),m=o(u,n("status","==","active"),n("ad_plan","==","premium"),d(4)),x=(await c(m)).docs.map(e=>({id:e.id,...e.data(),type:"ad",source:"advertising_portal"})),f=[];let h=0;const v=[...t,...p];for(let a=0;a<v.length;a+=6){const e=v.slice(a,a+6);if(f.push(...e),h<x.length){const e=x.slice(h,h+2);f.push(...e),h+=2}}w(f)}catch(e){w([])}finally{N(!1)}},[h]);i.useEffect(()=>{(null==f?void 0:f.uid)&&y()},[null==f?void 0:f.uid,y]);return b?t.jsx("div",{className:"px-4 py-2",children:t.jsx("div",{className:"flex gap-3 overflow-x-auto",children:[1,2,3,4,5].map(e=>t.jsx("div",{className:"flex-shrink-0 w-16 h-16 bg-muted rounded-full animate-pulse"},e))})}):t.jsx("div",{className:"px-4 py-2",children:t.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-2",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsxs(l,{variant:"outline",size:"sm",className:"w-16 h-16 rounded-full flex flex-col items-center justify-center gap-1 bg-muted/50 hover:bg-muted",onClick:()=>v("/my-profile"),children:[t.jsx(u,{className:"w-6 h-6"}),t.jsx("span",{className:"text-xs",children:"Tu historia"})]})}),j.map((e,s)=>t.jsxs("div",{className:"flex-shrink-0",children:[t.jsx("button",{onClick:()=>(e=>{switch(e.type){case"vip":case"story":v(`/profile/${e.id}`);break;case"ad":e.website&&window.open(e.website,"_blank")}})(e),className:"w-16 h-16 rounded-full relative overflow-hidden border-2 border-transparent hover:border-primary transition-colors",children:"ad"===e.type?t.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:t.jsx(m,{className:"w-8 h-8 text-white"})}):t.jsxs("div",{className:"relative w-full h-full",children:[t.jsx("img",{src:e.profile_picture_url||"/pwa-512x512.png",alt:e.alias||"Usuario",className:"w-full h-full object-cover",onError:e=>{e.target.src="/pwa-512x512.png"}}),e.is_vip&&t.jsx("div",{className:"absolute -top-1 -right-1",children:t.jsx(x,{className:"w-4 h-4 text-yellow-500 fill-current"})})]})}),t.jsx("div",{className:"text-center mt-1",children:t.jsx("span",{className:"text-xs text-muted-foreground truncate w-16 block",children:"ad"===e.type?"Publicidad":e.alias||"Usuario"})})]},`${e.type}-${e.id}`))]})})};export{f as default};
